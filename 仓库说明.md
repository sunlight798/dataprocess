# 仓库说明

## 这个仓库是做什么的？

这是一个 **CVE-Commit 匹配工具**，用于自动化查找 GitHub 仓库中的 CVE（通用漏洞披露）修复提交。

## 核心功能

### 📊 数据来源
- 从 PostgreSQL 数据库读取 CVE 信息和关联的 GitHub 仓库

### 🔍 智能搜索
- 使用 GitHub API 在 CVE 披露时间前后 6 个月的时间范围内搜索所有提交
- 自动处理 API 速率限制和仓库访问问题

### 🎯 提取与分析
- 提取指定时间范围内的所有 commit 信息
- 包含 commit 的 SHA、消息、作者、时间等完整信息
- 可选的智能匹配和评分功能（识别修复关键词、CVE 编号等）

### 💾 结果输出
- 将结果保存为 JSON 格式文件
- 包含详细的元数据和统计信息
- 支持批量处理和中间结果保存

## 使用场景

这个工具特别适合：

✅ **安全研究人员** - 研究 CVE 漏洞的修复模式和时间线  
✅ **开发团队** - 追踪和分析软件漏洞的修复历史  
✅ **学术研究** - 收集和分析开源软件安全修复数据  
✅ **漏洞管理** - 批量处理和关联 CVE 与代码修复

## 工作流程

```
[PostgreSQL 数据库] 
     ↓ 读取 CVE 信息
[CVE + GitHub 仓库 URL]
     ↓ 计算时间范围（披露前后 6 个月）
[GitHub API]
     ↓ 提取所有 commits
[Commit 数据]
     ↓ 可选：智能匹配和评分
[JSON 结果文件]
```

## 技术栈

- **Python 3.x** - 主要编程语言
- **PostgreSQL** - CVE 数据存储
- **GitHub REST API** - 获取 commit 数据
- **psycopg2** - 数据库连接
- **requests** - HTTP 请求
- **python-dateutil** - 时间处理

## 项目特点

🚀 **自动化** - 全流程自动化，无需人工干预  
⚡ **高效** - 支持批量处理，平均 2-5 秒/CVE  
🛡️ **容错** - 完善的错误处理和重试机制  
📝 **日志** - 详细的日志记录和统计信息  
🔧 **可配置** - 灵活的配置选项（时间范围、批处理大小等）  
💡 **易用** - 提供交互式启动脚本和清晰的文档

## 快速开始

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 配置
编辑 `config.py`，填写：
- 数据库连接信息（密码）
- GitHub API Token

### 3. 运行
```bash
# 使用启动脚本（推荐）
bash run.sh

# 或直接运行
python main.py
```

### 4. 查看结果
- 日志文件：`cve_commit_matching.log`
- 结果文件：`cve_commit_results_final_*.json`

## 详细文档

想了解更多？请查看：

- 📖 **[README.md](README.md)** - 完整的项目文档和使用说明
- 🚀 **[QUICKSTART.md](QUICKSTART.md)** - 快速开始指南
- 📋 **[USAGE.md](USAGE.md)** - 简要使用说明
- 📊 **[PROJECT_SUMMARY.txt](PROJECT_SUMMARY.txt)** - 项目完成总结

## 输出示例

```json
{
  "metadata": {
    "timestamp": "2025-11-12T10:30:00",
    "total_cves": 100,
    "processed_cves": 100,
    "total_commits": 5000,
    "repo_not_found": 5,
    "api_errors": 2
  },
  "results": [
    {
      "cve_id": "CVE-2020-7221",
      "repo_url": "https://github.com/MariaDB/server",
      "status": "success",
      "message": "成功提取 50 个commits",
      "time_range": {
        "since": "2019-08-04T17:15:00Z",
        "until": "2020-08-04T17:15:00Z"
      },
      "commits": [
        {
          "sha": "9d18b624...",
          "message": "Fix privilege escalation",
          "author": "Developer Name",
          "date": "2020-02-05T10:30:00Z",
          "html_url": "https://github.com/..."
        }
      ]
    }
  ]
}
```

## 常见问题

### Q: 这个工具会修改数据库吗？
A: 不会。工具只读取数据库中的 CVE 信息，不会进行任何写入或修改操作。

### Q: 需要什么权限的 GitHub Token？
A: 只需要 `public_repo` 权限即可，用于访问公开仓库的信息。

### Q: 处理速度有多快？
A: 平均每个 CVE 需要 2-5 秒，处理 100 个 CVE 大约需要 5-10 分钟。

### Q: 如果仓库不存在怎么办？
A: 程序会自动记录并跳过不存在的仓库，继续处理下一个 CVE。

## 许可证

本项目仅供学术研究使用。

---

如有其他问题，欢迎查看详细文档或提出 Issue！
